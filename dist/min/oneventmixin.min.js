/*!
 * OnEventMixin | Copyright (C) 2021 Peter KrÃ¶ner | peter@peterkroener.de | Dual license GPL-3.0-only/commercial
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).OnEventMixin=t()}(this,(function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e){return Symbol.for(`oneventmixin-${e}`)}class n{constructor(t,n){e(this,"_eventTarget",void 0),e(this,"_eventName",void 0),e(this,"_handlerValue",void 0),e(this,"_handler",(e=>{this._handlerValue&&this._handlerValue.call(this._eventTarget,e)})),this._eventTarget=t,this._eventName=n,this.setAttribute(this._eventTarget.getAttribute(`on${this._eventName}`))}setProperty(e){"function"==typeof e?(this._handlerValue=e,this._eventTarget.addEventListener(this._eventName,this._handler)):(this._eventTarget.removeEventListener(this._eventName,this._handler),this._handlerValue=null)}setAttribute(e){if("string"==typeof e){const t=new Function("event",e);Object.defineProperty(t,"name",{value:`on${this._eventName}`}),this._handlerValue=t,this._eventTarget.addEventListener(this._eventName,this._handler)}else this._eventTarget.removeEventListener(this._eventName,this._handler),this._handlerValue=null}getValue(){return this._handlerValue}}function r(e,r,i){return e[t(i)]||Object.defineProperty(e,t(i),{configurable:!1,enumerable:!1,writable:!1,value:new n(e,r)}),e[t(i)]}return function(e,t){if("function"!=typeof e||!e.prototype)throw new TypeError("First argument to OnEventMixin must be a custom element constructor");if(!t||"string"==typeof t||!t[Symbol.iterator])throw new TypeError("Second argument to OnEventMixin must be an iterable list of event names");const n=new Map(Array.from(t).map((e=>[`on${e=String(e).toLowerCase()}`,e])));if(0===n.size)return e;for(const[t,i]of n)t in e.prototype||Object.defineProperty(e.prototype,t,{enumerable:!1,configurable:!1,get(){return r(this,i,t).getValue()},set(e){r(this,i,t).setProperty(e)}});const i=(null==e?void 0:e.observedAttributes)||[],o=[...i,...Array.from(n.keys())];Object.defineProperty(e,"observedAttributes",{enumerable:!1,configurable:!0,get:()=>o});const a=e.prototype.attributeChangedCallback;return Object.defineProperty(e.prototype,"attributeChangedCallback",{enumerable:!1,configurable:!0,writable:!1,value:function(e,t,o){n.has(e)&&r(this,n.get(e),e).setAttribute(o),a&&i.includes(e)&&a.call(this,e,t,o)}}),new Proxy(e,{construct(e,t,r){const i=Reflect.construct(e,t,r);for(const[,e]of n){const t=`on${e}`;if(Object.prototype.hasOwnProperty.call(i,t)){const e=i[t];delete i[t],i[t]=e}}return i}})}}));
